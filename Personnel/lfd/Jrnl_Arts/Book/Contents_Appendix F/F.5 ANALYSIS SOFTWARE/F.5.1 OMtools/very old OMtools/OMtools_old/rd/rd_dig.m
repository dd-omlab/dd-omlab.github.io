% rd_dig.m:  % Read in the digital stimulus data.  %% written by: Jonathan Jacobs%             November 2001  (last mod: 11/02/01)disp( 'Loading digital stimuli data.' )digfile = [shortname, '.dig'];fid = fopen(digfile,'r');if fid == -1   disp('  <<No digital stimuli data file found>>')   returnenddigfiletext = fread(fid);digfiletext = setstr(digfiletext');fclose(fid);t_stim = []; stim_dur = []; whichLED = []; laser_state = []; vpixx_start = [];LEDangles = [NaN 20 18 16 14 12 10 8 6];[headerline, digfiletext, emptyLine, isEOF] = getnextl(digfiletext);i=1;[nextline, digfiletext, emptyLine, isEOF] = getnextl(digfiletext);while ~isEOF   [wordlist,numwords] = procline(nextline);   whichLED(i)    = str2num(wordlist(1,:));   stim_dur(i)    = str2num(wordlist(2,:));   laser_state(i) = str2num(wordlist(3,:));   t_stim(i)      = str2num(wordlist(4,:));   i=i+1;   [nextline, digfiletext, emptyLine, isEOF] = getnextl(digfiletext);end% init_time is the time of 1st analog samplet_stim = t_stim - init_time;whichLED = log2(whichLED) + 2;    %make '0th' LED #1 in LEDangles list nulls = isinf(whichLED);whichLED(nulls) = ones(nulls,1);disp(' To see it, type ''digstimplot'' after plotting the eye movement data.')clear nulls init_time fid digfiletext i nextline emptyLine isEOF