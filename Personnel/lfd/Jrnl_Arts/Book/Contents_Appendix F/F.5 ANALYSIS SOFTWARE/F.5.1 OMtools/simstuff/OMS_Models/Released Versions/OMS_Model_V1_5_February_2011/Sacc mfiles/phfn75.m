% PHfn75.m: a most inelegant way to determine the necessary pulse height% for a given desired saccade.  These numbers were obtained with "PGcalc"% and a plant preceded by a 1 ms delay block.% Eye position was measured at the end of the pulse, and was considered% god when it reached 75% of the target value.% Written by:  Jonathan Jacobs%              October 1998  (last mod: 10/19/98)function out = PHfunc(in);in = abs(in);% teeny tiny saccades -- 0.05 to 0.09 degreessmallmag = [ 0.9290    1.1142    1.2994    1.4844    1.6694];if in < 0.05, out = 0; return; endif (in >= 0.05) & (in < 0.1)   ind = fix((in-0.04)*100);   if ind==0; ind=1;end   out = smallmag(ind);   returnend% we go by 2.5 degree increments so that we only have to load% small (25 element) matrices.  If we had to load in values for% all fifty degrees at once, it would make the model unbearably slow.%%% this seems to be the best tradeoff between speed and partitioning effortif (in >= 0.1) & (in < 2.55)   mag = [...       1.8579    3.7141    5.5688    7.4221    9.2742 ...  %% 0.1 - 0.5      11.1253   12.9755   14.8249   16.6737   18.5219 ...  %% 0.6 - 1      20.3696   22.2169   24.0638   25.9104   27.7568 ...  %% 1.1 - 1.5      29.6029   31.4489   33.2948   35.1406   36.9863 ...  %% 1.6 - 2      38.8319   40.6775   42.5231   44.3686   46.2142 ...  %% 2.1 - 2.5    ];   ind = round(in*10);   out = mag(ind);   returnendif (in > 2.5) & (in < 5.05)   mag = [...      48.0598   49.9054   51.7510   53.5967   55.4424 ...  %% 2.6 - 3      57.2882   59.1340   60.9798   62.8257   64.6717 ...  %% 3.1 - 3.5      66.5176   68.3637   70.2098   72.0559   73.9021 ...  %% 3.6 - 4      75.7483   77.5946   79.4409   81.2873   83.1337 ...  %% 4.1 - 4.5      84.9801   86.8266   88.6731   90.5197   92.3663 ...  %% 4.6 - 5    ];   ind = round((in-2.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 5) & (in < 7.55)   mag = [...      94.2129   96.0596   97.9062   99.7530  101.5997 ...  %% 5.1 - 5.5     103.4465  105.2932   96.8844   98.5019  100.1225 ...  %% 5.6 - 6     101.7460  103.3721  105.0007  106.6317  108.2648 ...  %% 6.1 - 6.5     109.8999  111.5369  102.9695  104.4259  105.8865 ...  %% 6.6 - 7     107.3509  108.8188  110.2900  111.7641  113.2409 ...  %% 7.1 - 7.5    ];   ind = round((in-5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 7.5) & (in <= 10.05)   mag = [...     114.7202  116.2018  107.9074  109.2268  110.5517 ...  %% 7.6 - 8     111.8815  113.2158  114.5541  115.8961  117.2413 ...  %% 8.1 - 8.5     118.5896  119.9406  112.0027  113.2012  114.4070 ...  %% 8.6 - 9     115.6192  116.8371  118.0603  119.2880  120.5198 ...  %% 9.1 - 9.5     121.7554  122.9941  115.3796  116.4777  117.5845 ...  %% 9.6 - 10    ];   ind = round((in-7.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 10) & (in <= 12.55)   mag = [...     118.8950  119.9927  121.0991  113.8980  114.9062 ...  %% 10.1 - 10.5     115.9249  116.9526  117.9883  111.4646  112.4065 ...  %% 10.6 - 11     113.3590  114.3205  115.2899  109.3247  110.2068 ...  %% 11.1 - 11.5     111.0998  112.0020  112.9121  107.4324  108.2602 ...  %% 11.6 - 12     109.0995  109.9483  110.8051  105.7525  106.5306 ...  %% 12.1 - 12.5    ];   ind = round((in-10)*10);   if ind==0; ind=1;end   out = mag(ind);   returnend if (in > 12.5) & (in <= 15.0)   mag = [...     107.3209  108.1211  108.9298  104.2570  104.9889 ...  %% 12.6 - 13     105.7339  106.4898  107.2544  102.9229  103.6112 ...  %% 13.1 - 13.5     104.3141  105.0287  105.7530  101.6469  102.3103 ...  %% 13.6 - 14     102.9868  103.6738  104.3691  100.5732  101.1986 ...  %% 14.1 - 14.5     101.8387  102.4907  103.1518   99.5341  100.1393 ...  %% 14.6 - 15    ];   ind = round((in-12.5)*10);  if ind==0; ind=1;end  out = mag(ind);  returnendif (in > 15) & (in < 17.75)   mag = [...     100.7578  101.3868  102.0240   98.6662   99.2366 ...  %% 15.1 - 15.5      99.8227  100.4209  101.0285   97.8120   98.3660 ...  %% 15.6 - 16      98.9342   99.5133  100.1007   97.1089   97.6300 ...  %% 16.1 - 16.5      98.1684   98.7198   99.2810   96.4013   96.9092 ...  %% 16.6 - 17      97.4329   97.9683   98.5125   95.7588   96.2543 ...  %% 17.1 - 17.5    ];   ind = round((in-15.0)*10);  if ind==0; ind=1;end  out = mag(ind);  returnend if (in > 17.5) & (in < 20.05)   mag = [...      96.7643   97.2848   97.8130   95.2427   95.7079 ...  %% 17.6 - 18      96.1913   96.6880   97.1941   94.7077   95.1628 ...  %% 18.1 - 18.5      95.6347   96.1186   96.6111   94.2209   94.6665 ...  %% 18.6 - 19      95.1276   95.5996   96.0792   93.8467   94.2625 ...  %% 19.1 - 19.5      94.6987   95.1493   95.6096   93.4399   93.8480 ...  %% 19.6 - 20    ];   ind = round((in-17.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 20) & (in < 22.55)   mag = [...      94.2753   94.7156   95.1649   93.0697   93.4708 ...  %% 20.1 - 20.5      93.8896   94.3203   94.7591   92.7341   93.1283 ...  %% 20.6 - 21      93.5389   93.9604   94.3891   92.4302   92.8177 ...  %% 21.1 - 21.5      93.2203   93.6329   94.0519   92.2169   92.5761 ...  %% 21.6 - 22      92.9570   93.3518   93.7556   91.9639   92.3179 ...  %% 22.1 - 22.5    ];   ind = round((in-20.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 22.5) & (in < 25.05)   mag = [...      92.6923   93.0795   93.4750   91.7352   92.0844 ...  %% 22.6 - 23      92.4526   92.8326   93.2200   91.5296   91.8742 ...  %% 23.1 - 23.5      92.2363   92.6093   92.9890   91.3456   91.6855 ...  %% 23.6 - 24      92.0417   92.4079   92.7802   91.1814   91.5167 ...  %% 24.1 - 24.5      91.8672   92.2268   92.5919   91.0945   91.4013 ...  %% 24.6 - 25    ];   ind = round((in-22.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 25) & (in < 27.55)   mag = [...      91.7320   92.0768   92.4300   90.9618   91.2654 ...  %% 25.1 - 25.5      91.5915   91.9308   92.2777   90.8448   91.1454 ...  %% 25.6 - 26      91.4672   91.8012   92.1421   90.7431   91.0408 ...  %% 26.1 - 26.5      91.3583   91.6870   92.0221   90.6556   90.9504 ...  %% 26.6 - 27      91.2637   91.5874   91.9168   90.5815   90.8733 ...  %% 27.1 - 27.5     ];   ind = round((in-25.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 27.5) & (in < 30.05)   mag = [...      91.1825   91.5012   91.8252   90.5200   90.8088 ...  %% 27.6 - 28      91.1139   91.4278   91.7464   90.4701   90.7560 ...  %% 28.1 - 28.5      91.0571   91.3663   91.6798   90.4312   90.7143 ...  %% 28.6 - 29      91.0115   91.3161   91.6245   90.4028   90.6829 ...  %% 29.1 - 29.5      90.9762   91.2764   91.5800   90.4336   90.6864 ...  %% 29.6 - 30    ];   ind = round((in-27.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 30) & (in < 32.55)   mag = [...      90.9635   91.2530   91.5488   90.4209   90.6720 ...  %% 30.1 - 30.5      90.9462   91.2320   91.5235   90.4168   90.6663 ...  %% 30.6 - 31      90.9378   91.2199   91.5073   90.4211   90.6691 ...  %% 31.1 - 31.5      90.9378   91.2164   91.4997   90.4334   90.6799 ...  %% 31.6 - 32      90.9458   91.2208   91.5002   90.4533   90.6982 ...  %% 32.1 - 32.5    ];   ind = round((in-30.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 32.5) & (in < 35.05)   mag = [...      90.9613   91.2329   91.5085   90.4804   90.7236 ...  %% 32.6 - 33      90.9840   91.2523   91.5242   90.5143   90.7558 ...  %% 33.1 - 33.5      91.0136   91.2786   91.5468   90.5547   90.7945 ...  %% 33.6 - 34      91.0496   91.3114   91.5760   90.6012   90.8394 ...  %% 34.1 - 34.5      91.0918   91.3504   91.6116   90.6535   90.8901 ...  %% 34.6 - 35    ];   ind = round((in-32.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 35) & (in < 37.55)   mag = [...      91.1399   91.3954   91.6533   90.7115   90.9463 ...  %% 35.1 - 35.5      91.1936   91.4461   91.7007   90.7748   91.0079 ...  %% 35.6 - 36      91.2526   91.5021   91.7536   90.8432   91.0746 ...  %% 36.1 - 36.5      91.3168   91.5634   91.8117   90.9164   91.1461 ...  %% 36.6 - 37      91.3859   91.6296   91.8749   90.9943   91.2222 ...  %% 37.1 - 37.5    ];   ind = round((in-35.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 37.5) & (in < 40.05)   mag = [...      91.4596   91.7006   91.9429   91.1141   91.3170 ...  %% 37.6 - 38      91.5431   91.7781   92.0163   91.1984   91.4007 ...  %% 38.1 - 38.5      91.6251   91.8577   92.0933   91.2868   91.4885 ...  %% 38.6 - 39      91.7112   91.9415   92.1745   91.3792   91.5804 ...  %% 39.1 - 39.5      91.8014   92.0294   92.2598   91.4755   91.6761 ...  %% 39.6 - 40    ];   ind = round((in-37.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 40) & (in < 42.55)   mag = [...      91.8954   92.1211   92.3491   91.5756   91.7755 ...  %% 40.1 - 40.5      91.9931   92.2166   92.4421   91.6792   91.8785 ...  %% 40.6 - 41      92.0943   92.3157   92.5388   91.7863   91.9848 ...  %% 41.1 - 41.5      92.1990   92.4182   92.6390   91.8967   92.0945 ...  %% 41.6 - 42      92.3069   92.5240   92.7426   92.0103   92.2073 ...  %% 42.1 - 42.5    ];   ind = round((in-40.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 42.5) & (in < 45.05)   mag = [...      92.4181   92.6331   92.8495   92.1269   92.3232 ...  %% 42.6 - 43      92.5323   92.7453   92.9595   92.2466   92.4420 ...  %% 43.1 - 43.5      92.6494   92.8604   93.0725   92.3691   92.5636 ...  %% 43.6 - 44      92.7694   92.9785   93.1885   92.4943   92.6880 ...  %% 44.1 - 44.5      92.8922   93.0993   93.3073   92.6223   92.8151 ...  %% 44.6 - 45    ];   ind = round((in-42.5)*10);   out = mag(ind);   returnendif (in > 45) & (in <= 47.55)   mag = [...       93.0177   93.2229   93.4289   92.7528   92.9447 ...  %% 45.1 - 45.5      93.1457   93.3491   93.5531   92.8858   93.0768 ...  %% 45.6 - 46      93.2762   93.4778   93.6799   93.0213   93.2113 ...  %% 46.1 - 46.5      93.4091   93.6089   93.8092   93.1591   93.3481 ...  %% 46.6 - 47      93.5444   93.7424   93.9409   93.2991   93.4872 ...  %% 47.1 - 47.5    ];   ind = round((in-45.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 47.5) & (in < 50.05)   mag = [...      93.6820   93.8783   94.0750   93.4414   93.6285 ...  %% 47.6 - 48      93.8217   94.0163   94.2113   93.5858   93.7719 ...  %% 48.1 - 48.5      93.9636   94.1566   94.3498   93.7323   93.9174 ...  %% 48.6 - 49      94.1076   94.2990   94.4905   93.8808   94.0648 ...  %% 49.1 - 49.5      94.2536   94.4434   94.6333   94.0312   94.2142 ...  %% 49.6 - 50    ];   ind = round((in-47.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnend