% PHfn_pk.m: a most inelegant way to determine the necessary pulse height% for a given desired saccade.  These numbers were obtained with "PGcalc"% and a plant preceded by a 1 ms delay block.% Eye position was measured at its peak.% Written by:  Jonathan Jacobs%              October 1998  (last mod: 10/25/98)function out = PHfunc(in);in = abs(in);% teeny tiny saccades -- 0.05 to 0.09 degreessmallmag = [ 0.6917    0.8296    0.9674    1.1052    1.2430];if in < 0.05, out = 0; return; endif (in >= 0.05) & (in < 0.1)   ind = fix((in-0.04)*100);   if ind==0; ind=1;end   out = smallmag(ind);   returnend% we go by 2.5 degree increments so that we only have to load% small (25 element) matrices.  If we had to load in values for% all fifty degrees at once, it would make the model unbearably slow.%%% this seems to be the best tradeoff between speed and partitioning effortif (in >= 0.1) & (in < 2.55)   mag = [...       1.3834    2.7654    4.1462    5.5261    6.9053 ...  %% 0.1 - 0.5       8.2840    9.6624   11.0404   12.4183   13.7960 ...  %% 0.6 - 1      15.1737   16.5512   17.9288   19.3064   20.6840 ...  %% 1.1 - 1.5      22.0616   23.4393   24.8170   26.1947   27.5725 ...  %% 1.6 - 2      28.9504   30.3283   31.7062   33.0842   34.4622 ...  %% 2.1 - 2.5    ];   ind = round(in*10);   out = mag(ind);   returnendif (in > 2.5) & (in < 5.05)   mag = [...      35.8402   37.2183   38.5964   39.9746   41.3527 ...  %% 2.6 - 3      42.7309   44.1091   45.4873   46.8656   48.2438 ...  %% 3.1 - 3.5      49.6221   51.0004   52.3787   53.7570   55.1353 ...  %% 3.6 - 4      56.5136   57.8919   59.2702   60.6486   62.0269 ...  %% 4.1 - 4.5      63.4053   64.7836   66.1619   67.5403   68.9187 ...  %% 4.6 - 5    ];   ind = round((in-2.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 5) & (in < 7.55)   mag = [...      70.2970   71.6754   73.0537   74.4321   75.8104 ...  %% 5.1 - 5.5      77.1888   78.5672   75.3062   76.5601   77.8194 ...  %% 5.6 - 6      79.0835   80.3516   81.6233   82.8981   84.1755 ...  %% 6.1 - 6.5      85.4551   86.7367   83.1609   84.3351   85.5159 ...  %% 6.6 - 7      86.7024   87.8938   89.0893   90.2884   91.4904 ...  %% 7.1 - 7.5    ];   ind = round((in-5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 7.5) & (in <= 10.05)   mag = [...      92.6949   93.9016   90.2272   91.3199   92.4222 ...  %% 7.6 - 8      93.5326   94.6498   95.7727   96.9003   98.0319 ...  %% 8.1 - 8.5      99.1669  100.3046   96.5379   97.5641   98.6017 ...  %% 8.6 - 9      99.6489  100.7040  101.7656  102.8326  103.9041 ...  %% 9.1 - 9.5     104.9793  106.0575  102.2590  103.2232  104.2012 ...  %% 9.6 - 10    ];   ind = round((in-7.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 10) & (in <= 12.55)   mag = [...     105.1904  106.1889  107.1949  103.4009  104.3245 ...  %% 10.1 - 10.5     105.2612  106.2084  107.1641  103.5879  104.4609 ...  %% 10.6 - 11     105.3490  106.2491  107.1588  103.7057  104.5479 ...  %% 11.1 - 11.5     105.4038  106.2707  107.1462  103.9078  104.7047 ...  %% 11.6 - 12     105.5181  106.3442  107.1802  104.0280  104.7995 ...  %% 12.1 - 12.5    ];   ind = round((in-10)*10);   if ind==0; ind=1;end   out = mag(ind);   returnend if (in > 12.5) & (in <= 15.0)   mag = [...     105.5861  106.3843  107.1915  104.1599  104.9082 ...  %% 12.6 - 13     105.6703  106.4430  107.2236  104.3743  105.0833 ...  %% 13.1 - 13.5     105.8095  106.5484  107.2968  104.5236  105.2132 ...  %% 13.6 - 14     105.9186  106.6358  107.3616  104.6663  105.3376 ...  %% 14.1 - 14.5     106.0235  106.7202  107.4246  104.8871  105.5222 ...  %% 14.6 - 15    ];   ind = round((in-12.5)*10);  if ind==0; ind=1;end  out = mag(ind);  returnendif (in > 15) & (in < 17.75)   mag = [...     106.1762  106.8437  107.5209  105.0435  105.6635 ...  %% 15.1 - 15.5     106.3012  106.9513  107.6102  105.2079  105.8141 ...  %% 15.6 - 16     106.4364  107.0702  107.7119  105.3779  105.9706 ...  %% 16.1 - 16.5     106.5783  107.1965  107.8219  105.6092  106.1682 ...  %% 16.6 - 17     106.7477  107.3412  107.9443  105.7769  106.3249 ...  %% 17.1 - 17.5    ];   ind = round((in-15.0)*10);  if ind==0; ind=1;end  out = mag(ind);  returnend if (in > 17.5) & (in < 20.05)   mag = [...     106.8920  107.4721  108.0609  105.9514  106.4890 ...  %% 17.6 - 18     107.0445  107.6118  108.1871  106.1329  106.6606 ...  %% 18.1 - 18.5     107.2049  107.7601  108.3224  106.3209  106.8390 ...  %% 18.6 - 19     107.3725  107.9161  108.4661  106.5698  107.0557 ...  %% 19.1 - 19.5     107.5642  108.0871  108.6192  106.7515  107.2295 ...  %% 19.6 - 20    ];   ind = round((in-17.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 20) & (in < 22.55)   mag = [...     107.7288  108.2416  108.7629  106.9381  107.4089 ...  %% 20.1 - 20.5     107.8996  108.4028  108.9137  107.1304  107.5941 ...  %% 20.6 - 21     108.0766  108.5704  109.0714  107.3279  107.7848 ...  %% 21.1 - 21.5     108.2592  108.7441  109.2354  107.5303  107.9806 ...  %% 21.6 - 22     108.4471  108.9234  109.4055  107.7364  108.1801 ...  %% 22.1 - 22.5    ];   ind = round((in-20.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 22.5) & (in < 25.05)   mag = [...     108.6391  109.1070  109.5801  107.9361  108.3733 ...  %% 22.6 - 23     108.8248  109.2845  109.7490  108.1944  108.6019 ...  %% 23.1 - 23.5     109.0329  109.4771  109.9289  108.3984  108.8011 ...  %% 23.6 - 24     109.2260  109.6632  110.1074  108.6062  109.0044 ...  %% 24.1 - 24.5     109.4234  109.8539  110.2908  108.8179  109.2117 ...  %% 24.6 - 25    ];   ind = round((in-22.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 25) & (in < 27.55)   mag = [...     109.6250  110.0489  110.4787  109.0333  109.4227 ...  %% 25.1 - 25.5     109.8304  110.2480  110.6709  109.2522  109.6373 ...  %% 25.6 - 26     110.0396  110.4509  110.8671  109.4710  109.8517 ...  %% 26.1 - 26.5     110.2487  110.6540  111.0637  109.6864  110.0629 ...  %% 26.6 - 27     110.4545  110.8539  111.2573  109.9049  110.2772 ...  %% 27.1 - 27.5     ];   ind = round((in-25.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 27.5) & (in < 30.05)   mag = [...     110.6638  111.0574  111.4547  110.1264  110.4947 ...  %% 27.6 - 28     110.8763  111.2644  111.6557  110.3509  110.7152 ...  %% 28.1 - 28.5     111.0919  111.4746  111.8602  110.6246  110.9608 ...  %% 28.6 - 29     111.3211  111.6930  112.0704  110.8514  111.1850 ...  %% 29.1 - 29.5     111.5415  111.9087  112.2810  111.0809  111.4120 ...  %% 29.6 - 30    ];   ind = round((in-27.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 30) & (in < 32.55)   mag = [...     111.7646  112.1273  112.4945  111.3129  111.6415 ...  %% 30.1 - 30.5     111.9904  112.3486  112.7110  111.5467  111.8728 ...  %% 30.6 - 31     112.2180  112.5719  112.9296  111.7753  112.0987 ...  %% 31.1 - 31.5     112.4402  112.7898  113.1428  112.0060  112.3269 ...  %% 31.6 - 32     112.6649  113.0103  113.3588  112.2392  112.5576 ...  %% 32.1 - 32.5    ];   ind = round((in-30.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 32.5) & (in < 35.05)   mag = [...     112.8920  113.2333  113.5775  112.4746  112.7905 ...  %% 32.6 - 33     113.1215  113.4588  113.7987  112.7123  113.0257 ...  %% 33.1 - 33.5     113.3533  113.6867  114.0224  112.9520  113.2630 ...  %% 33.6 - 34     113.5873  113.9168  114.2485  113.1938  113.5024 ...  %% 34.1 - 34.5     113.8233  114.1491  114.4768  113.4375  113.7437 ...  %% 34.6 - 35    ];   ind = round((in-32.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 35) & (in < 37.55)   mag = [...     114.0614  114.3835  114.7074  113.6831  113.9868 ...  %% 35.1 - 35.5     114.3014  114.6199  114.9401  113.9305  114.2319 ...  %% 35.6 - 36     114.5432  114.8583  115.1748  114.1797  114.4786 ...  %% 36.1 - 36.5     114.7869  115.0986  115.4115  114.4245  114.7210 ...  %% 36.6 - 37     115.0262  115.3345  115.6440  114.6698  114.9640 ...  %% 37.1 - 37.5    ];   ind = round((in-35.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 37.5) & (in < 40.05)   mag = [...     115.2662  115.5713  115.8773  114.9503  115.2202 ...  %% 37.6 - 38     115.5120  115.8112  116.1131  115.1969  115.4657 ...  %% 38.1 - 38.5     115.7551  116.0515  116.3502  115.4453  115.7129 ...  %% 38.6 - 39     116.0000  116.2936  116.5892  115.6953  115.9617 ...  %% 39.1 - 39.5     116.2466  116.5374  116.8300  115.9469  116.2122 ...  %% 39.6 - 40    ];   ind = round((in-37.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 40) & (in < 42.55)   mag = [...     116.4948  116.7829  117.0726  116.2002  116.4642 ...  %% 40.1 - 40.5     116.7446  117.0300  117.3169  116.4549  116.7178 ...  %% 40.6 - 41     116.9960  117.2787  117.5628  116.7112  116.9728 ...  %% 41.1 - 41.5     117.2488  117.5289  117.8103  116.9689  117.2293 ...  %% 41.6 - 42     117.5031  117.7807  118.0593  117.2280  117.4871 ...  %% 42.1 - 42.5    ];   ind = round((in-40.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 42.5) & (in < 45.05)   mag = [...     117.7588  118.0339  118.3099  117.4885  117.7464 ...  %% 42.6 - 43     118.0158  118.2885  118.5620  117.7501  118.0066 ...  %% 43.1 - 43.5     118.2740  118.5442  118.8152  118.0073  118.2624 ...  %% 43.6 - 44     118.5277  118.7955  119.0641  118.2658  118.5195 ...  %% 44.1 - 44.5     118.7827  119.0483  119.3144  118.5256  118.7780 ...  %% 44.6 - 45    ];   ind = round((in-42.5)*10);   out = mag(ind);   returnendif (in > 45) & (in <= 47.55)   mag = [...      119.0392  119.3024  119.5662  118.7867  119.0378 ...  %% 45.1 - 45.5     119.2969  119.5579  119.8194  119.0491  119.2988 ...  %% 45.6 - 46     119.5560  119.8148  120.0740  119.3128  119.5611 ...  %% 46.1 - 46.5     119.8163  120.0730  120.3300  119.5777  119.8246 ...  %% 46.6 - 47     120.0779  120.3324  120.5873  119.8438  120.0893 ...  %% 47.1 - 47.5    ];   ind = round((in-45.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 47.5) & (in < 50.05)   mag = [...     120.3406  120.5931  120.8459  120.1110  120.3552 ...  %% 47.6 - 48     120.6046  120.8551  121.1057  120.3794  120.6222 ...  %% 48.1 - 48.5     120.8697  121.1182  121.3669  120.6489  120.8903 ...  %% 48.6 - 49     121.1360  121.3825  121.6292  120.9195  121.1595 ...  %% 49.1 - 49.5     121.4034  121.6480  121.8927  121.1912  121.4298 ...  %% 49.6 - 50    ];   ind = round((in-47.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnend