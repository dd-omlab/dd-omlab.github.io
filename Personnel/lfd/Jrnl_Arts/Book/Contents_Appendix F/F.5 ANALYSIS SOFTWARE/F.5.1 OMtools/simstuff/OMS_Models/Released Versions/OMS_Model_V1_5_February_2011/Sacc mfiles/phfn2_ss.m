% PHfn2_ss.m: % This new pulse height table minimizes the difference between the target and the eye at all the gaze angles from 0 - 50, every 0.1.% The unwanted nonlinearity was minimized as compared to PHfn_ss.% Model 1_4 uses this table.% Created by: Zhong Wang, Dec. 2007% Last Modified: Zhong Wang, June, 2008function out = PHfn_ss(in);sgn = sign(in);in = abs(in);if in > 50   in = 50;end% teeny tiny saccades -- 0.05 to 0.09 degreessmallmag = [0.6366    0.7635    0.8903    1.0170    1.1438];if in < 0.05, out = 0; return; endif (in >= 0.05) & (in < 0.1)   ind = fix((in-0.04)*100);   if ind==0; ind=1;end   out = smallmag(ind)*sgn;   returnend% we go by 2.5 degree increments so that we only have to load% small (25 element) matrices.  If we had to load in values for% all fifty degrees at once, it would make the model unbearably slow.%%% this seems to be the best tradeoff between speed and partitioning effortif (in >= 0.1) & (in < 2.55)   mag = [...       1.2732    2.5449    3.8155    5.0852    6.3542 ...  %% 0.1 - 0.5       7.6228    8.8910   10.1590   11.4269   12.6946 ...  %% 0.6 - 1      13.9623   15.2300   16.4977   17.7654   19.0331 ...  %% 1.1 - 1.5      20.3009   21.5688   22.8366   24.1046   25.3725 ...  %% 1.6 - 2      26.6406   27.9086   29.1767   30.4449   31.7131 ...  %% 2.1 - 2.5    ];   ind = round(in*10);   out = mag(ind)*sgn;   returnendif (in > 2.5) & (in < 5.05)   mag = [...      32.9813   34.2495   35.5177   36.7860   38.0543 ...  %% 2.6 - 3      39.3226   40.5910   41.8593   43.1277   44.3961 ...  %% 3.1 - 3.5      45.6644   46.9328   48.2012   49.4696   50.7380 ...  %% 3.6 - 4      52.0064   53.2749   54.5433   55.8117   57.0801 ...  %% 4.1 - 4.5      58.3486   59.6170   60.8854   62.1538   63.4223 ...  %% 4.6 - 5    ];   ind = round((in-2.5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 5) & (in < 7.55)   mag = [...      60.6907   61.5083   63.8166   64.1249   64.8332 ...  %% 5.1 - 5.5      65.9415   67.2498   67.9581   68.9664   69.9747 ...  %% 5.6 - 6      69.0830   69.5913   70.3996   71.2079   72.5162 ...  %% 6.1 - 6.5      73.8245   74.6328   75.9411   76.8494   77.6577 ...  %% 6.6 - 7      78.8660   77.3743   77.9826   78.2909   80.0992 ...  %% 7.1 - 7.5    ];   ind = round((in-5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 7.5) & (in < 10.05)   mag = [...      80.9251   81.5182   82.1164   82.7146   83.3128 ...  %% 7.6 - 8      83.9110   84.5092   85.1074   85.7056   86.3038...  %% 8.1 - 8.5      86.9020   87.5002   88.0984   88.6966   89.2948  ...  %% 8.6 - 9      89.8930   90.4912   91.0894   91.6876   92.2858 ...  %% 9.1 - 9.5      92.8840   93.4822   94.0804   94.6786   91.3704 ...  %% 9.6 - 10    ];   ind = round((in-7.5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 10) & (in < 12.55)   mag = [...      91.3829   91.4969   91.6109   91.7249   91.8389 ...  %% 10.1 - 10.5      91.9529   92.0669   92.1809   92.2949   92.4089 ...  %% 10.6 - 11      92.5229   92.6369   92.7509   92.8649   92.9789 ...  %% 11.1 - 11.5      93.0929   93.2069   93.3209   93.4349   93.5489...  %% 11.6 - 12      93.6629   93.7769   93.8909   94.0049   94.1189 ...  %% 12.1 - 12.5    ];   ind = round((in-10)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnend if (in > 12.5) & (in < 15.05)   mag = [...      94.2279   94.2891   94.3485   94.4079   94.4673 ...  %% 12.6 - 13      94.5267   94.5861   94.6455   94.7049   94.7643 ...  %% 13.1 - 13.5      94.8237   94.8831   94.9425   95.0019   95.0613 ...  %% 13.6 - 14      95.1207   95.1801   95.2395   95.2989   95.3583...  %% 14.1 - 14.5      95.4177   95.4771   95.5365   95.5959   95.6545 ...  %% 14.6 - 15    ];   ind = round((in-12.5)*10);  if ind==0; ind=1;end  out = mag(ind)*sgn;  returnendif (in > 15) & (in < 17.55)   mag = [...      95.6550   96.2090   96.2312   96.2534   96.2756 ...  %% 15.1 - 15.5      96.2978   96.3200   96.3422   96.3644   96.3866 ...  %% 15.6 - 16      96.4088   96.4310   96.4532   96.4754   96.4976 ...  %% 16.1 - 16.5      96.5198   96.5420   96.5642   96.5864   96.0086 ...  %% 16.6 - 17      96.6308   96.6530   96.6752   96.6974   96.7196 ...  %% 17.1 - 17.5    ];   ind = round((in-15.0)*10);  if ind==0; ind=1;end  out = mag(ind)*sgn;  returnend if (in > 17.5) & (in < 20.05)   mag = [...      96.8014   96.9370   97.0530   97.1693   91.2034 ...  %% 17.6 - 18      91.2061   91.2481   91.2901   91.3321   91.3741 ...  %% 18.1 - 18.5      91.4161   91.4581   91.5001   91.5421   91.5841 ...  %% 18.6 - 19      91.6261   91.6681   91.7101   91.7521   91.7941 ...  %% 19.1 - 19.5      91.8361   91.8781   91.9201   91.9621   92.0034 ...  %% 19.6 - 20    ];   ind = round((in-17.5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 20) & (in < 22.55)   mag = [...      92.0454   92.0874   92.1294   92.1714   92.2134 ...  %% 20.1 - 20.5      92.2554   92.2974   92.3394   92.3814   92.4234 ...  %% 20.6 - 21      92.4654   92.5074   92.5494   92.5914   92.6334 ...  %% 21.1 - 21.5      92.6754   92.7174   92.7594   92.8014   92.8434 ...  %% 21.6 - 22      92.8854   92.9274   92.9694   93.0114   93.0534 ...  %% 22.1 - 22.5    ];   ind = round((in-20.0)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 22.5) & (in < 25.05)   mag = [...      93.0954   93.1374   93.1794   93.2214   93.2634 ...  %% 22.6 - 23      93.3054   93.3474   93.3894   93.4314   93.4734 ...  %% 23.1 - 23.5      93.5154   93.5574   93.5994   93.6414   93.6834 ...  %% 23.6 - 24      93.7254   93.7674   93.8094   93.8514   93.8934 ...  %% 24.1 - 24.5      93.9354   93.9774   94.0194   94.0614   90.0958 ...  %% 24.6 - 25       ];   ind = round((in-22.5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 25) & (in < 27.55)   mag = [...      90.0963   90.0967   90.0972   90.0977   90.0982 ...  %% 25.1 - 25.5      90.0986   90.0991   90.0996   90.1000   90.1005 ...  %% 25.6 - 26      90.1010   90.1015   90.1019   90.1024   90.1029 ...  %% 26.1 - 26.5      90.1034   90.1038   90.1043   90.1048   90.1052 ...  %% 26.6 - 27      90.1057   90.1062   90.1067   90.1071   90.1076 ...  %% 27.1 - 27.5     ];   ind = round((in-25.0)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 27.5) & (in < 30.05)   mag = [...      90.1594   90.2112   90.2630   90.3148   90.3666 ...  %% 27.6 - 28      90.4184   90.4702   90.5220   90.5738   90.6256 ...  %% 28.1 - 28.5      90.6774   90.7292   90.7810   90.8328   90.8846 ...  %% 28.6 - 29      90.9364   90.9882   91.0400   91.0918   91.1436 ...  %% 29.1 - 29.5      91.1954   91.2472   91.2990   91.3508   91.4026 ...  %% 29.6 - 30    ];   ind = round((in-27.5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 30) & (in < 32.55)   mag = [...      91.4075   91.4123   91.4172   91.4221   91.4269 ...  %% 30.1 - 30.5      91.4318   91.4366   91.4415   91.4464   91.4512 ...  %% 30.6 - 31      91.4561   91.4610   91.4658   91.4707   91.4756 ...  %% 31.1 - 31.5      91.4804   91.4853   91.4902   91.4950   91.4999 ...  %% 31.6 - 32      91.5047   91.5096   91.5145   91.5193   91.5242 ...  %% 32.1 - 32.5    ];   ind = round((in-30.0)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 32.5) & (in < 35.05)   mag = [...      90.5242   90.5296   90.5350   90.5404   90.5458 ...  %% 32.6 - 33      90.5512   90.5566   90.5620   90.5674   90.5728 ...  %% 33.1 - 33.5      90.5782   90.5836   90.5890   90.5944   90.5998 ...  %% 33.6 - 34      90.6052   90.6106   90.6160   90.6214   90.6268 ...  %% 34.1 - 34.5      90.6322   90.6376   90.6430   90.6484   90.6538  ...  %% 34.6 - 35    ];   ind = round((in-32.5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 35) & (in < 37.55)   mag = [...      90.6543   90.6682   90.6821   90.6960   90.7099 ...  %% 35.1 - 35.5      90.7237   90.7376   90.7515   90.7654   90.7793 ...  %% 35.6 - 36      90.7932   90.8071   90.8210   90.8348   90.8487 ...  %% 36.1 - 36.5      90.8626   90.8765   90.8904   90.9043   90.9182 ...  %% 36.6 - 37      90.9321   90.9459   90.9598   90.9737   90.9876 ...  %% 37.1 - 37.5    ];   ind = round((in-35.0)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 37.5) & (in < 40.05)   mag = [...      90.6304   90.6331   90.6359   90.6386   90.6413 ...  %% 37.6 - 38      90.6441   90.6468   90.6496   90.6523   90.6550 ...  %% 38.1 - 38.5      90.6578   90.6605   90.6632   90.6660   90.6687 ...  %% 38.6 - 39      90.6715   90.6742   90.6769   90.6797   90.6824 ...  %% 39.1 - 39.5      90.6851   90.6879   90.6906   90.6934   90.6961 ...  %% 39.6 - 40    ];   ind = round((in-37.5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 40) & (in < 42.55)   mag = [...      90.6970   90.6978   90.6987   90.6996   90.7004 ...  %% 40.1 - 40.5      90.7013   90.7021   90.7030   90.7039   90.7047 ...  %% 40.6 - 41      90.7056   90.7065   90.7073   90.7082   90.7090 ...  %% 41.1 - 41.5      90.7099   90.7108   90.7116   90.7125   90.7134 ...  %% 41.6 - 42      90.7142   90.7151   90.7159   90.7168   90.7177 ...  %% 42.1 - 42.5    ];   ind = round((in-40.0)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 42.5) & (in < 45.05)   mag = [...      90.0449   90.0487   90.0525   90.0564   90.0602 ...  %% 42.6 - 43      90.0640   90.0678   90.0717   90.0755   90.0793 ...  %% 43.1 - 43.5      90.0832   90.0870   90.0908   90.0946   90.0984 ...  %% 43.6 - 44      90.1023   90.1061   90.1099   90.1137   90.1176 ...  %% 44.1 - 44.5      90.1214   90.1252   90.1290   90.1329   90.1367 ...  %% 44.6 - 45    ];   ind = round((in-42.5)*10);   out = mag(ind)*sgn;   returnendif (in > 45) & (in <= 47.55)   mag = [...       90.3689   90.3857   90.4025   90.4192   90.4359 ...  %% 45.1 - 45.5      90.4527   90.4694   90.4862   90.5029   90.5197 ...  %% 45.6 - 46      90.5365   90.5532   90.5699   90.5867   90.6034 ...  %% 46.1 - 46.5      90.6202   90.6369   90.6537   90.6705   90.6872 ...  %% 46.6 - 47      90.7039   90.7207   90.7374   90.7542   90.7709 ...  %% 47.1 - 47.5    ];   ind = round((in-45.0)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnendif (in > 47.5) & (in < 50.05)   mag = [...      90.6013   90.6083   90.6154   90.6224   90.6295 ...  %% 47.6 - 48      90.6365   90.6435   90.6506   90.6576   90.6647 ...  %% 48.1 - 48.5      90.6717   90.6788   90.6858   90.6928   90.6999 ...  %% 48.6 - 49      90.7069   90.7140   90.7210   90.7280   90.7351 ...  %% 49.1 - 49.5      90.7421   90.7492   90.7562   90.7633   90.7703 ...  %% 49.6 - 50    ];   ind = round((in-47.5)*10);   if ind==0; ind=1;end   out = mag(ind)*sgn;   returnend