% set up "pwtstbed" with the PG Width function to be tested.% Set "Pulse 1 Magnitude" to be "pwgoal" and set "Pulse 1 duration"% to be "pwstoptime"stimlist = [(0.1:0.1:0.9), (1:9), (10:5:50)];if ~exist('showplot'),showplot=0;endcount=0;pwstoptime=0.3;stimdur=pwstoptime;on_pt=[];off_pt=[];pul_dur=[];for i = stimlist   count=count+1;   tw=[];pwout=[];   goal=i;   rk45('pwtstbed',pwstoptime,[],[1e-3,.001,.001,0,0,2]);   % how long was the pulse duration?   if ~all(pwout) & ~all(~pwout)      off_pts = find(pwout==0);      if length(off_pts)>=2         pul_dur(count) = twClock(off_pts(2)-1) - twClock(off_pts(1));       else         disp('Error: no second "off" point found!')         pul_dur(count)=0;      end      disp(['Saccade: ' num2str(goal)  '              ,   duration: '...                  num2str(pul_dur(count)) ' sec'])   else      disp(['Stim: ' num2str(goal) ',   Hmmmm.'])   end   if (showplot)      plot(t,pwout)      xlabel('Saccade magnitude (deg)')      ylabel('Saccade duration (sec)')      pause   end endplot(stimlist,pul_dur)xlabel('Saccade magnitude (deg)')ylabel('Saccade duration (sec)')