% PHfunc.m: a most inelegant way to determine the necessary pulse height% for a given desired saccade.  These numbers were obtained with "PGcalc"% and a plant preceded by a 1 ms delay block.% Written by:  Jonathan Jacobs%              October 1998  (last mod: 10/19/98)function out = PHfunc(in);in = abs(in);% teeny tiny saccades -- 0.05 to 0.09 degreessmallmag = [1.2368    1.4836    1.7303    1.9769    2.2234];if in < 0.05, out = 0; return; endif (in >= 0.05) & (in < 0.1)   ind = fix((in-0.04)*100);   if ind==0; ind=1;end   out = smallmag(ind);   returnend% we go by 2.5 degree increments so that we only have to load% small (25 element) matrices.  If we had to load in values for% all fifty degrees at once, it would make the model unbearably slow.%%% this seems to be the best tradeoff between speed and partitioning effortif (in >= 0.1) & (in < 2.55)   mag = [...        2.4727    4.9438    7.4135    9.8819   12.3493 ...     %%% 0.1 - 0.5       14.8158   17.2814   19.7464   22.2107   24.6745 ...     %%% 0.6 - 1.0       27.1379   29.6009   32.0635   34.5259   36.9881 ...     %%% 1.1 - 1.5       39.4501   41.9119   44.3736   46.8352   49.2967 ...     %%% 1.6 - 2.0       51.7582   54.2197   56.6811   59.1426   61.6040 ...     %%% 2.1 - 2.5    ];   ind = round(in*10);   out = mag(ind);   returnendif (in > 2.5) & (in < 5.05)   mag = [...       64.0654   66.5269   68.9884   71.4499   73.9115 ...     %%% 2.6 - 2.0       76.3731   78.8347   81.2964   83.7581   86.2199 ...     %%% 3.1 - 3.5       88.6817   91.1436   93.6055   96.0674   98.5294 ...     %%% 3.6 - 4.0      100.9914  103.4535  105.9156  108.3778  110.8400 ...     %%% 4.1 - 4.5      113.3022  115.7645  118.2268  120.6891  123.1514 ...     %%% 4.6 - 5.0    ];   ind = round((in-2.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 5) & (in < 7.55)   mag = [...      125.6138  128.0763  130.5387  133.0012  135.4637 ...     %%% 5.1 - 5.5      137.9262  140.3887  128.9894  131.1602  133.3342 ...     %%% 5.6 - 6.0      135.5110  137.6906  139.8726  142.0569  144.2434 ...     %%% 6.1 - 6.5      146.4320  148.6224  137.1441  139.0988  141.0580 ...     %%% 6.6 - 7.0      143.0213  144.9884  146.9589  148.9326  150.9093 ...     %%% 7.1 - 7.5    ];   ind = round((in-5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 7.5) & (in <= 10.05)   mag = [...      152.8886  154.8703  143.7143  145.4894  147.2702 ...     %%% 7.6 - 8.0      149.0562  150.8469  152.6419  154.4407  156.2430 ...     %%% 8.1 - 8.5      158.0484  159.8567  149.1496  150.7680  152.3938 ...     %%% 8.6 - 9.0      154.0262  155.6646  157.3083  158.9568  160.6095 ...     %%% 9.1 - 9.5      162.2660  163.9258  153.6405  155.1283  156.6249 ...     %%% 9.6 - 10.0    ];   ind = round((in-7.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 10) & (in <= 12.55)   mag = [...      158.1292  159.6403  161.1574  151.6341  153.0082 ...     %%% 10.1 - 10.5       154.3923  155.7852  157.1858  148.4156  149.6999 ...     %%% 10.6 - 11.0       150.9944  152.2975  153.6082  145.5739  146.7788 ...     %%% 11.1 - 11.5       147.9940  149.2178  150.4489  143.1386  144.2592 ...     %%% 11.6 - 12.0       145.3922  146.5357  147.6880  140.9017  141.9564 ...     %%% 12.1 - 12.5    ];   ind = round((in-10)*10);   if ind==0; ind=1;end   out = mag(ind);   returnend if (in > 12.5) & (in <= 15.0)   mag = [...      143.0244  144.1034  145.1914  138.8240  139.8332 ...     %%% 12.6 - 13.0       140.8540  141.8842  142.9222  137.0361  137.9907 ...     %%% 13.1 - 13.5       138.9578  139.9350  140.9203  135.4351  136.3385 ...     %%% 13.6 - 14.0       137.2555  138.1835  139.1203  133.9987  134.8533 ...     %%% 14.1 - 14.5       135.7233  136.6055  137.4973  132.6271  133.4526 ...     %%% 14.6 - 15.0     ];   ind = round((in-12.5)*10);  if ind==0; ind=1;end  out = mag(ind);  returnendif (in > 15) & (in < 17.75)   mag = [...      134.2919  135.1420  136.0004  131.4602  132.2425 ...     %%% 15.1 - 15.5       133.0408  133.8513  134.6713  130.3334  131.0918 ...     %%% 15.6 - 16.0       131.8645  132.6481  133.4400  129.3829  130.1016 ...     %%% 16.1 - 16.5       130.8374  131.5860  132.3443  128.4507  129.1497 ...     %%% 16.6 - 17.0       129.8642  130.5901  131.3245  127.6769  128.3380 ...     %%% 17.1 - 17.5    ];   ind = round((in-15.0)*10);  if ind==0; ind=1;end  out = mag(ind);  returnend if (in > 17.5) & (in < 20.05)   mag = [...      129.0183  129.7125  130.4169  126.9016  127.5465 ...     %%% 17.6 - 18.0       128.2090  128.8840  129.5681  126.1967  126.8266 ...     %%% 18.1 - 18.5       127.4723  128.1292  128.7942  125.6267  126.2212 ...     %%% 18.6 - 19.0       126.8363  127.4657  128.1053  125.0387  125.6208 ...     %%% 19.1 - 19.5       126.2217  126.8357  127.4587  124.5041  125.0743 ...     %%% 19.6 - 20.0    ];   ind = round((in-17.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 20) & (in < 22.55)   mag = [...      125.6619  126.2612  126.8686  124.0190  124.5779 ...     %%% 20.1 - 20.5       125.1525  125.7378  126.3302  123.6446  124.1705 ...     %%% 20.6 - 21.0       124.7182  125.2802  125.8519  123.2402  123.7569 ...     %%% 21.1 - 21.5       124.2938  124.8438  125.4025  122.8738  123.3818 ...     %%% 21.6 - 22.0       123.9083  124.4469  124.9931  122.5429  123.0425 ...     %%% 22.1 - 22.5    ];   ind = round((in-20.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 22.5) & (in < 25.05)   mag = [...      123.5590  124.0865  124.6208  122.2450  122.7362 ...     %%% 22.6 - 23.0       123.2431  123.7598  124.2827  121.9773  122.4604 ...     %%% 23.1 - 23.5       122.9579  123.4644  123.9763  121.7936  122.2470 ...     %%% 23.6 - 24.0       122.7221  123.2105  123.7069  121.5752  122.0223 ...     %%% 24.1 - 24.5       122.4896  122.9691  123.4559  121.3810  121.8220 ...     %%% 24.6 - 25.0    ];   ind = round((in-22.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 25) & (in < 27.55)   mag = [...      122.2819  122.7528  123.2303  121.2096  121.6448 ...     %%% 25.1 - 25.5       122.0973  122.5600  123.0285  121.0595  121.4889 ...     %%% 25.6 - 26.0       121.9343  122.3889  122.8489  120.9294  121.3530 ...     %%% 26.1 - 26.5       121.7915  122.2383  122.6899  120.8178  121.2358 ...     %%% 26.6 - 27.0       121.6675  122.1068  122.5503  120.7751  121.1643 ...     %%% 27.1 - 27.5    ];   ind = round((in-25.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 27.5) & (in < 30.05)   mag = [...      121.5766  122.0016  122.4336  120.6933  121.0784 ...     %%% 27.6 - 28.0       121.4852  121.9038  122.3286  120.6268  121.0080 ...     %%% 28.1 - 28.5       121.4095  121.8218  122.2397  120.5750  120.9523 ...     %%% 28.6 - 29.0       121.3486  121.7547  122.1660  120.5370  120.9105 ...     %%% 29.1 - 29.5       121.3016  121.7018  122.1066  120.5121  120.8817 ...     %%% 29.6 - 30.0    ];   ind = round((in-27.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 30) & (in < 32.55)   mag = [...      121.2678  121.6622  122.0607  120.4994  120.8653 ...     %%% 30.1 - 30.5       121.2464  121.6351  122.0276  120.4984  120.8605 ...     %%% 30.6 - 31.0       121.2367  121.6199  122.0064  120.5083  120.8666 ...     %%% 31.1 - 31.5       121.2381  121.6159  121.9967  120.5286  120.8832 ...     %%% 31.6 - 32.0       121.2500  121.6226  121.9979  120.6043  120.9308 ...     %%% 32.1 - 32.5     ];   ind = round((in-30.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 32.5) & (in < 35.05)   mag = [...      121.2817  121.6439  122.0114  120.6405  120.9648 ...     %%% 32.6 - 33.0       121.3120  121.6697  122.0322  120.6857  121.0078 ...     %%% 33.1 - 33.5       121.3514  121.7047  122.0624  120.7395  121.0594 ...     %%% 33.6 - 34.0       121.3995  121.7485  122.1014  120.8016  121.1192 ...     %%% 34.1 - 34.5       121.4558  121.8005  122.1489  120.8714  121.1867 ...     %%% 34.6 - 35.0     ];   ind = round((in-32.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 35) & (in < 37.55)   mag = [...      121.5199  121.8605  122.2044  120.9487  121.2618 ...     %%% 35.1 - 35.5      121.5915  121.9281  122.2676  121.0331  121.3439 ...     %%% 35.6 - 36.0       121.6702  122.0028  122.3381  121.1242  121.4327 ...     %%% 36.1 - 36.5       121.7557  122.0845  122.4156  121.2219  121.5281 ...     %%% 36.6 - 37.0       121.8478  122.1728  122.4999  121.3258  121.6297 ...     %%% 37.1 - 37.5     ];   ind = round((in-35.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 37.5) & (in < 40.05)   mag = [...      121.9461  122.2674  122.5906  121.4355  121.7371 ...     %%% 37.6 - 38.0       122.0504  122.3681  122.6874  121.5510  121.8503 ...     %%% 38.1 - 38.5       122.1604  122.4746  122.7902  121.6719  121.9689 ...     %%% 38.6 - 39.0       122.2759  122.5866  122.8986  121.7981  122.0928 ...     %%% 39.1 - 39.5       122.3967  122.7040  123.0125  121.9292  122.2216 ...     %%% 39.6 - 40.0    ];   ind = round((in-37.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 40) & (in < 42.55)   mag = [...      122.5226  122.8266  123.1316  122.0652  122.3553 ...     %%% 40.1 - 40.5       122.6534  122.9541  123.2557  122.2058  122.4937 ...     %%% 40.6 - 41.0       122.7888  123.0863  123.3847  122.3817  122.6464 ...     %%% 41.1 - 41.5       122.9320  123.2242  123.5187  122.5289  122.7926 ...     %%% 41.6 - 42.0       123.0759  123.3654  123.6568  122.6803  122.9431 ...     %%% 42.1 - 42.5     ];   ind = round((in-40.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 42.5) & (in < 45.05)   mag = [...      123.2241  123.5108  123.7993  122.8359  123.0976 ...     %%% 42.6 - 43.0       123.3764  123.6604  123.9460  122.9954  123.2560 ...     %%% 43.1 - 43.5       123.5326  123.8139  124.0967  123.1587  123.4182 ...     %%% 43.6 - 44.0       123.6926  123.9713  124.2513  123.3258  123.5840 ...     %%% 44.1 - 44.5       123.8563  124.1325  124.4097  123.4964  123.7534 ...     %%% 44.6 - 45.0    ];   ind = round((in-42.5)*10);   out = mag(ind);   returnendif (in > 45) & (in <= 47.55)   mag = [...       124.0235  124.2972  124.5718  123.6704  123.9263 ...     %%% 45.1 - 45.5       124.1942  124.4654  124.7375  123.8478  124.1024 ...     %%% 45.6 - 46.0       124.3683  124.6370  124.9065  124.0284  124.2817 ...     %%% 46.1 - 46.5       124.5455  124.8119  125.0789  124.2121  124.4642 ...     %%% 46.6 - 47.0       124.7259  124.9899  125.2545  124.3989  124.6496 ...     %%% 47.1 - 47.5     ];   ind = round((in-45.0)*10);   if ind==0; ind=1;end   out = mag(ind);   returnendif (in > 47.5) & (in < 50.05)   mag = [...      124.9093  125.1710  125.4333  124.5886  124.8380 ...     %%% 47.6 - 48.0       125.0956  125.3551  125.6151  124.7811  125.0292 ...     %%% 48.1 - 48.5       125.2848  125.5421  125.7998  124.9764  125.2232 ...     %%% 48.6 - 49.0       125.4768  125.7319  125.9874  125.1744  125.4198 ...     %%% 49.1 - 49.5       125.6715  125.9245  126.1778  125.3749  125.6190 ...     %%% 49.6 - 50.0    ];   ind = round((in-47.5)*10);   if ind==0; ind=1;end   out = mag(ind);   returnend