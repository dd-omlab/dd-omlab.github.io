% omstart.m: execute when MATLAB starts up.%  1) Checks for valid OMtools installation%  2) Checks for OMtools preferences dir%  3) Checks location of default data dir%  3) Changes current dir to OMtools.%% This file should be in omtools/omtoolsdirs along with% findomtools.m, findomprefs.m, dataroot.m and ompath.m.% Written by:  Jonathan Jacobs%              March 2017 - October 2020 (last mod: 10/12/20)% 12 Oct 2020: Cleaned and updated to link to latest version location.   %              Removed call to 'setomtools'function omstart( ~ )prevdir=pwd;% Make sure OMtools are on the ML path.ompathdisp(' ')% Find locally installed version.% Search for cloud version (stored on box.com)omstatus = omcheck;switch omstatus   case 1      % most recent version is installed   case -666      fprintf('Could not find local OMtools install.\n');      return   case -999      %fprintf('Could not find cloud OMtools install.\n');   case -1      fprintf('Could not determine the most recent version.\n');   case 0      %fprintf('Please install the most recent version.\n');   otherwise      fprintf('I don''t know what happened.\n');      returnendomprefpath = findomprefs;temp = find(omprefpath==filesep);ompp = omprefpath(1:temp(end));%fprintf('OMtools prefs: %s\n', omprefpath)disp(' ')disp(['OMtools prefs:   <a href="matlab: system([''open '' findomprefs]);">' ...   omprefpath '</a>'])ztprefpath = findztprefs;temp=find(ztprefpath==filesep);ztpp = ztprefpath(1:temp(end));if ~strcmpi(ompp,ztpp)   disp(['zoomtool prefs: <a href="matlab: system([''open '' findztprefs]);">' ...   ztprefpath '</a>'])enddatarootpath = dataroot('r');disp(['Data folder:     <a href="matlab: system([''open '' dataroot(''r'')]);">' ...   datarootpath '</a>. Type dataroot(''w'') to select a new location.' ])if ismac   %fprintf('\nStarting MATLABWindow.\n');   mlw_dummy   pause(1)   ML_W_switch('ml')   cd(findomtools);cd('utils')   if ~exist('MLW_act.app','file') || ~exist('ML_act.app','file')      beep;pause(0.25);beep;pause(0.25);beep      fprintf('\n--Just one more thing:\n')      fprintf('I need to install applescripts to manage MATLAB.\n');      fprintf('I will try to open the "/OMtools/utils" folder for you,\n');      fprintf('extract the files, and clean up. Fingers crossed!\n');      system('open .');      ! unzip -q -n ML{W}_act.zip      ! rm -r _MACOSX            if exist('ML_act.app','file') && exist('MLW_act.app','file')         fprintf('"ML_act.app" and "ML_W_act.app" moved to /OMtools/utils.\n')         fprintf('Update successful! Testing...\n');         try    ML_W_switch('ml')         catch, end         try    ML_W_switch('mlw')         catch, end         else         fprintf('Oops... Something didn''t work :(\n')         fprintf('Carefully read the help text and check my work.\n\n')         help ML_W_switch         return      end   endend%disp('Ready for use.')try    cd(prevdir)catch, fprintf('Could not return to previous dir: %s\n',prevdir); cd(findomtools); end