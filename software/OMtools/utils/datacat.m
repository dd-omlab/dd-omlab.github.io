% This function is used to generate data for wavelet analysis from a segment% of data where the subject demonstrates good fixation.%% Perfectly lined up foveations are concatenated to make a 8 min long record% After you have read in the data, use 'zoomtool' to select a region of interest% by placing the cursors on the beginning and end of the segment to mark the start% and stop points.%% For a smooth join between the end of one cycle and the beginning of the next,% the start point should be one sample ahead in the direction of the waveform.% Written by:  zxw & jbj%              May 2005  (last mod: 05/27/2005)function f = datacatglobal xyCur1Mat xyCur2Mat lh rh samp_freq% find zoomtool windowzoomwindow = findme('zoomed window');if zoomwindow<=0    disp('"Zoomtool" needs to be running for "datacat" to work.')    returnendga = get(zoomwindow,'CurrentAxes');temp=get(ga,'UserData');hlist=temp{2};cur1horH=hlist{1};   cur2horH=hlist{7};cur1vertH=hlist{4};  cur2vertH=hlist{10};c1x = get(cur1horH, 'XData'); c1x = c1x(1);c2x = get(cur2horH, 'XData'); c2x = c2x(2);ch = get(ga,'Children');zoomedline = findobj(ch,'UserData','zoomed');zoomed_xdata = get(zoomedline,'XData');zoomed_ydata = get(zoomedline,'YData');zoom_xfactor = get(get(ga,'xlabel'),'UserData');good_pts     = zoomed_xdata(find(~isnan(zoomed_xdata)));zoom_xmin    = min(good_pts);recordname=input('Enter the record name: ','s');%whicheye=input('Which eye (lh/rh)? ','s');minutes=input('Extend to how many minutes? ');if isempty(samp_freq)    samp_freq = input('Enter the sampling frequency: ');end   % always select the startpoint from the leftmost cursor, and % the stop point from the rightmost cursorstartpt = round((c1x-zoom_xmin)/zoom_xfactor)+1;stoppt  = round((c2x-zoom_xmin)/zoom_xfactor)+1;if startpt>stoppt   temp=startpt;   startpt=stoppt;   stoppt=temp;endpicked_period = zoomed_ydata(startpt:stoppt);[r,c]=size(picked_period);if c>r, picked_period = picked_period'; end% calculate the number of repetitions needednum = floor( minutes*60 / ((stoppt-startpt+1)/samp_freq) );extended_wf=picked_period;for (i=1:num)	extended_wf=cat(1,extended_wf,picked_period);end% plot the waveform to see if you are happy with itt=maket(extended_wf);figure; plot(t,extended_wf);zoomtool;yorn=lower(input('Do you wish to save this result (y/n)? ', 's'));% must type in 'y' to save the concatenated waveformif yorn(1)~='y'	returnend	% type in "y" then the concatenated data are savedfilename = recordname;varname = [recordname '_ext'];% if the desired name for the data is, e.g., 'cmw', the following 'eval'% command is equivalent to typing in 'cmw = extended_wf' in the command line,% assigning the data array to the variable name specified.eval([varname ' = extended_wf;'])% save the data array with the specified name in a file with the specified nameeval(['save ' filename ' ' varname ]);